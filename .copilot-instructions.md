# Copilot Instructions for Spective 

## Project Overview

Spective is a comprehensive talent management platform that connects professionals with companies. It's built as a modern React TypeScript application with a robust backend infrastructure.

### Key Features
- **Professional Profiles**: Skills, experience, education, availability management
- **Company Dashboard**: Browse professionals, manage company information, file management
- **Admin Panel**: User management, content management, system administration
- **Email System**: Automated notifications, welcome emails, approval workflows
- **Cron Jobs**: Availability reminders, scheduled email notifications
- **Document Management**: File upload/download, document library

## Tech Stack & Architecture

### Frontend
- **React 18.3.1** with **TypeScript** for type safety
- **Vite** as build tool and dev server
- **React Router DOM** for client-side routing
- **Tailwind CSS** for utility-first styling
- **shadcn/ui** for accessible, customizable UI components
- **React Hook Form + Zod** for form handling and validation
- **TanStack Query** for server state management
- **Lucide React** for consistent iconography

### Backend & Services
- **Supabase** for database, authentication, and real-time features
- **Resend** for transactional email delivery
- **Vercel** for hosting and serverless functions
- **Express.js** for API server functionality

### Development Tools
- **ESLint** for code linting with TypeScript rules
- **PostCSS + Autoprefixer** for CSS processing
- **Concurrently** for running multiple dev processes

## Code Organization

```
src/
├── components/           # React components organized by feature
│   ├── admin/           # Admin panel components
│   ├── auth/            # Authentication forms and flows
│   ├── company/         # Company-specific components
│   ├── layout/          # Layout and navigation components
│   ├── profile/         # Professional profile components
│   ├── registration/    # User registration wizards
│   └── ui/              # shadcn/ui base components
├── hooks/               # Custom React hooks
├── integrations/        # External service integrations (Supabase)
├── lib/                 # Utilities, services, and configuration
│   ├── email-service.ts # Email sending functionality
│   ├── email-templates.ts # Email template management
│   └── utils.ts         # General utility functions
├── pages/               # Page-level components
└── App.tsx              # Main application component

api/                     # Vercel serverless functions
├── cron/               # Scheduled jobs
└── *.js                # API endpoints

supabase/               # Database migrations and configuration
docs/                   # Various .md documentation files
```

## Code Conventions

### TypeScript
- Use strict TypeScript with proper type definitions
- Prefer interfaces over types for object shapes
- Use Zod schemas for runtime validation
- Avoid `any` types - use proper typing or `unknown`
- Use React.FC sparingly, prefer explicit component typing

### React Patterns
- Use functional components with hooks
- Prefer custom hooks for complex state logic
- Use React Hook Form for form management
- Implement proper error boundaries
- Use React.memo() for performance optimization when needed

### Styling
- Use Tailwind CSS utility classes
- Follow responsive-first design (mobile-first)
- Use shadcn/ui components as base, customize via CSS variables
- Maintain consistent spacing using Tailwind's scale
- Use semantic color tokens (e.g., `text-muted-foreground`)

### File Naming
- Components: PascalCase (e.g., `UserProfile.tsx`)
- Hooks: camelCase with "use" prefix (e.g., `useAuth.ts`)
- Utilities: camelCase (e.g., `formatDate.ts`)
- Constants: UPPER_SNAKE_CASE
- Pages: PascalCase matching route names

## Development Workflow

### Getting Started
```bash
npm install                 # Install dependencies
npm run dev                # Start development server
npm run dev:api            # Start email API server
npm run dev:full           # Start both frontend and API
```

### Build & Deploy
```bash
npm run build              # Production build
npm run preview            # Preview production build
npm run lint               # Run ESLint
```

### Environment Setup
Create `.env.local` with required variables:
```env
VITE_SUPABASE_URL=your_supabase_url
VITE_SUPABASE_ANON_KEY=your_supabase_anon_key
SUPABASE_SERVICE_ROLE_KEY=your_service_role_key
RESEND_API_KEY=your_resend_api_key
RESEND_FROM_EMAIL=your_from_email
```

## Key Patterns & Best Practices

### State Management
- Use React Query for server state
- Use React Hook Form for form state
- Use local state (useState) for component-specific state
- Use Supabase real-time subscriptions for live updates

### Error Handling
- Use try-catch blocks for async operations
- Display user-friendly error messages via toast notifications
- Log errors appropriately for debugging
- Implement fallback UI states

### Data Fetching
- Use React Query hooks for API calls
- Implement loading and error states
- Use optimistic updates where appropriate
- Cache data efficiently with proper invalidation

### Form Handling
```typescript
// Standard form pattern with React Hook Form + Zod
const formSchema = z.object({
  email: z.string().email(),
  name: z.string().min(1)
});

const form = useForm<z.infer<typeof formSchema>>({
  resolver: zodResolver(formSchema)
});
```

### Email System
- Use `EmailTemplates` class for consistent email formatting
- Variables are replaced using `{{ variableName }}` syntax
- All emails should have both HTML and text versions
- Use `useEmail` hook for sending emails from components

### Database Patterns
- Use Supabase client for database operations
- Implement Row Level Security (RLS) policies
- Use typed database helpers from `src/integrations/supabase`
- Handle real-time subscriptions properly (cleanup on unmount)

## Testing Guidelines

Currently, the project has minimal formal testing infrastructure. When adding tests:

- Use existing test files as patterns (`test-*.js` files)
- Focus on critical business logic and user flows
- Test email templates and cron job functionality
- Validate form schemas and data transformations

## Deployment & Infrastructure

### Vercel Deployment
- Automatic deployment on push to main branch
- Environment variables configured in Vercel dashboard
- Serverless functions in `/api` directory
- Static site generation for optimal performance

### Cron Jobs
- Availability reminder emails run daily
- Test cron endpoints: `/api/test-cron`
- Monitor via Vercel function logs

### Database
- Supabase provides PostgreSQL database
- Migrations in `supabase/migrations/`
- Use Supabase CLI for local development

## Domain Knowledge

### User Types
- **Professionals**: Create profiles, manage availability, showcase skills
- **Companies**: Browse professionals, manage company info, download documents  
- **Admins**: Full system access, user management, content moderation

### Key Workflows
1. **Registration**: Multi-step wizards for professional/company signup
2. **Profile Management**: Edit personal info, skills, experience, education
3. **Company Dashboard**: Search/filter professionals, manage favorites
4. **Admin Panel**: User approval, content management, system settings
5. **Email Notifications**: Welcome emails, approval notifications, availability reminders

### Business Rules
- Users must be approved by admin before full access
- Professionals can set availability dates for job searching
- Companies can save professionals to favorites
- Email notifications sent for key events (approval, availability changes)
- Distance calculations between professionals and companies

## Common Tasks & Solutions

### Adding New Components
1. Create in appropriate `src/components/` subdirectory
2. Use shadcn/ui base components when possible
3. Implement proper TypeScript interfaces
4. Add to relevant page or parent component
5. Test responsive behavior

### Database Changes
1. Create migration in `supabase/migrations/`
2. Update TypeScript types in `src/integrations/supabase/`
3. Test locally with `supabase db reset`
4. Deploy via Supabase dashboard or CLI

### Adding Email Templates
1. Add template function to `EmailTemplates` class
2. Use variable replacement pattern: `{{ variableName }}`
3. Include both HTML and text versions
4. Test with actual email data
5. Add to `useEmail` hook if needed

### Performance Considerations
- Use React.lazy() for code splitting large pages
- Optimize images and use appropriate formats
- Implement virtual scrolling for large lists
- Use React Query's caching effectively
- Monitor bundle size with Vite's build analyzer

## Security Considerations
- All API routes should validate user permissions
- Use Supabase RLS for data access control  
- Sanitize user inputs, especially in admin areas
- Validate file uploads (type, size, content)
- Use HTTPS for all communications
- Store sensitive data in environment variables only

## Troubleshooting Common Issues

### Build Errors
- Check TypeScript errors first (`npm run build`)
- Ensure all imports are correctly typed
- Verify environment variables are set

### Database Issues
- Check Supabase connection status
- Verify RLS policies allow required operations
- Test with Supabase local development

### Email Problems
- Verify Resend API key and from-email configuration
- Check email template variable replacement
- Test with `/api/test-cron` endpoint

When contributing to this project, focus on maintaining consistency with existing patterns, proper TypeScript usage, and responsive design principles.